name: Sync to Quartz Site

on:
  push:
    branches: [ main ]

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout vault
        uses: actions/checkout@v4

      - name: Sync to Quartz
        env:
          QUARTZ_TOKEN: ${{ secrets.QUARTZ_TOKEN }}
        run: |
          git clone https://x-access-token:$QUARTZ_TOKEN@github.com/koblade009/quartz.git
          rsync -av --delete --exclude=.git --exclude=.obsidian ./ quartz/content/
          cd quartz
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add .
          git commit -m "Auto-sync from vault" || echo "No changes"
          git push
